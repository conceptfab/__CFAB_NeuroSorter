{
  "type": "training",
  "info": "EfficientNet-B4-40-Claude",
  "description": "EfficientNet-B4-40-Claude",
  "data_required": "40-45 klas (np. 42), zalecane >100-150 obrazów treningowych i >20-30 walidacyjnych na klasę. Dane walidacyjne w osobnym folderze (stosunek 80/20).",
  "hardware_required": "GPU z >10-12GB VRAM (np. RTX 3070Ti/4070 lub lepsza), CPU wielordzeniowy, RAM 64-128GB.",
  "config": {
    "model": {
      "architecture": "EfficientNet",
      "variant": "EfficientNet-B4",
      "input_size": 380,
      "num_classes": 32,
      "pretrained": true,
      "pretrained_weights": "imagenet",
      "feature_extraction_only": false,
      "activation": "swish",
      "dropout_at_inference": false,
      "global_pool": "avg",
      "last_layer_activation": "softmax"
    },
    "training": {
      "epochs": 120,
      "batch_size": 64,
      "learning_rate": 0.00015,
      "optimizer": "AdamW",
      "scheduler": {
        "type": "CosineAnnealingWarmRestarts",
        "T_0": 10,
        "T_mult": 2,
        "eta_min": 1e-7
      },
      "num_workers": 12,
      "warmup_epochs": 8,
      "warmup_lr_init": 1e-6,
      "mixed_precision": true,
      "gradient_accumulation_steps": 2,
      "gradient_clip": 1.0,
      "evaluation_freq": 1,
      "use_ema": true,
      "ema_decay": 0.9999,
      "freeze_base_model": true,
      "unfreeze_layers": "all",
      "unfreeze_strategy": "gradual"
    },
    "regularization": {
      "weight_decay": 0.0001,
      "label_smoothing": 0.1,
      "dropout_rate": 0.4,
      "drop_connect_rate": 0.2,
      "momentum": 0.9,
      "epsilon": 1e-6,
      "stochastic_depth": {
        "use": true,
        "survival_probability": 0.75
      },
      "swa": {
        "use": true,
        "start_epoch": 90,
        "lr_swa": 5e-5
      }
    },
    "augmentation": {
      "basic": {
        "use": true,
        "rotation": 25,
        "brightness": 0.25,
        "contrast": 0.25,
        "saturation": 0.15,
        "hue": 0.05,
        "shift": 0.1,
        "zoom": 0.2,
        "horizontal_flip": true,
        "vertical_flip": false
      },
      "mixup": {
        "use": true,
        "alpha": 0.25
      },
      "cutmix": {
        "use": true,
        "alpha": 1.0
      },
      "autoaugment": {
        "use": true,
        "policy": "imagenet"
      },
      "randaugment": {
        "use": true,
        "n": 2,
        "m": 10
      },
      "trivialaugment": {
        "use": false
      },
      "random_erase": {
        "use": true,
        "probability": 0.3,
        "scale": [0.02, 0.33],
        "ratio": [0.3, 3.3]
      },
      "grid_distortion": {
        "enabled": true,
        "probability": 0.2,
        "distort_limit": 0.1
      }
    },
    "preprocessing": {
      "normalization": {
        "mean": [0.485, 0.456, 0.406],
        "std": [0.229, 0.224, 0.225]
      },
      "resize_mode": "bicubic",
      "cache_dataset": true,
      "scaling": {
        "method": "Bicubic",
        "maintain_aspect_ratio": true,
        "pad_to_square": true,
        "pad_mode": "reflection",
        "pad_value": 0
      },
      "random_resize_crop": {
        "enabled": true,
        "size": 380,
        "scale": [0.8, 1.0],
        "ratio": [0.75, 1.33]
      }
    },
    "monitoring": {
      "metrics": {
        "accuracy": true,
        "precision": true,
        "recall": true,
        "f1": true,
        "topk": [3, 5],
        "confusion_matrix": true,
        "auc": true,
        "gpu_utilization": true,
        "memory_usage": true
      },
      "logging": {
        "use_tensorboard": true,
        "tensorboard_log_dir": "logs/EfficientNet-B4_42cat_profile",
        "use_wandb": false,
        "save_to_csv": true,
        "csv_log_path": "logs/EfficientNet-B4_42cat_profile/training_log.csv",
        "logging_freq": "epoch"
      },
      "visualization": {
        "use_gradcam": false,
        "use_feature_maps": false
      },
      "early_stopping": {
        "use": true,
        "monitor": "val_loss",
        "patience": 20,
        "min_delta": 0.0001,
        "mode": "min"
      },
      "checkpointing": {
        "use": true,
        "save_dir": "checkpoints/EfficientNet-B4_42cat_profile",
        "filename": "best_model_epoch_{epoch:03d}_valloss_{val_loss:.4f}.pt",
        "monitor": "val_loss",
        "save_best_only": true,
        "mode": "min",
        "save_frequency": 1,
        "top_k": 3
      }
    },
    "advanced": {
      "seed": 42,
      "deterministic": false,
      "class_weights": "balanced",
      "sampler": "weighted_random",
      "tta": {
        "use": true,
        "num_augmentations": 5
      },
      "cross_validation": {
        "use": false
      },
      "distributed": {
        "use": false,
        "backend": "nccl",
        "world_size": 1,
        "rank": 0
      },
      "export_onnx": false,
      "quantization": {
        "use": false
      },
      "optimization": {
        "batch_size": 64,
        "num_workers": 12,
        "use_mixed_precision": true,
        "memory_efficient": true,
        "cudnn_benchmark": true,
        "pin_memory": true
      }
    }
  }
}
