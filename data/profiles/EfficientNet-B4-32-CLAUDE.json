{
  "type": "training",
  "info": "EfficientNet-B4 Claude",
  "description": "Profil treningowy oparty o EfficientNet-B4 zoptymalizowany dla klasyfikacji obrazów z 40-80 kategoriami. Zbalansowane parametry dla wysokiej dokładności przy zachowaniu rozsądnego czasu treningu.",
  "data_required": "Zbiór 40-80 klas, minimum 200-250 obrazów treningowych i 40-60 walidacyjnych na klasę. Zalecany podział 80/20 między treningiem a walidacją.",
  "hardware_required": "GPU z min. 16GB VRAM (np. RTX 3080/A5000 lub lepsze), CPU min. 10 rdzeni, RAM min. 48GB.",
  "config": {
    "train_dir": "",
    "val_dir": "",
    "model": {
      "architecture": "EfficientNet",
      "variant": "EfficientNet-B4",
      "input_size": 380,
      "num_classes": 40,
      "pretrained": true,
      "pretrained_weights": "imagenet",
      "feature_extraction_only": false,
      "activation": "swish",
      "dropout_at_inference": false,
      "global_pool": "avg",
      "last_layer_activation": "softmax"
    },
    "training": {
      "epochs": 200,
      "batch_size": 32,
      "learning_rate": 0.0003,
      "optimizer": "AdamW",
      "scheduler": {
        "type": "CosineAnnealingWarmRestarts",
        "T_0": 10,
        "T_mult": 2,
        "eta_min": 5e-8
      },
      "num_workers": 12,
      "warmup_epochs": 8,
      "warmup_lr_init": 1e-6,
      "mixed_precision": true,
      "gradient_accumulation_steps": 6,
      "gradient_clip": 1.0,
      "evaluation_freq": 1,
      "use_ema": true,
      "ema_decay": 0.9998,
      "freeze_base_model": true,
      "unfreeze_layers": "last_block",
      "unfreeze_strategy": "unfreeze_gradual_end",
      "unfreeze_after_epochs": 30,
      "frozen_lr": 1e-5,
      "unfrozen_lr": 0.0002,
      "validation_split": 0.2
    },
    "regularization": {
      "weight_decay": 0.00003,
      "label_smoothing": 0.1,
      "dropout_rate": 0.4,
      "drop_connect_rate": 0.2,
      "gradient_clip": 1.0,
      "momentum": 0.9,
      "epsilon": 1e-6,
      "stochastic_depth": {
        "use": true,
        "survival_probability": 0.8
      },
      "swa": {
        "use": true,
        "start_epoch": 120,
        "lr_swa": 1e-5
      }
    },
    "augmentation": {
      "basic": {
        "use": true,
        "rotation": 20,
        "brightness": 0.2,
        "contrast": 0.2,
        "saturation": 0.2,
        "hue": 0.05,
        "shift": 0.1,
        "zoom": 0.15,
        "horizontal_flip": true,
        "vertical_flip": false
      },
      "mixup": {
        "use": true,
        "alpha": 0.4
      },
      "cutmix": {
        "use": true,
        "alpha": 1.0
      },
      "autoaugment": {
        "use": true,
        "policy": "imagenet"
      },
      "randaugment": {
        "use": false,
        "n": 2,
        "m": 9
      },
      "trivialaugment": {
        "use": false
      },
      "random_erase": {
        "use": true,
        "probability": 0.25,
        "scale": [0.02, 0.3],
        "ratio": [0.3, 3.0]
      },
      "grid_distortion": {
        "enabled": true,
        "probability": 0.15,
        "distort_limit": 0.1
      },
      "resize": {
        "enabled": false
      }
    },
    "preprocessing": {
      "resize": {
        "enabled": true,
        "size": [380, 380],
        "mode": "bicubic"
      },
      "normalize": {
        "enabled": true,
        "mean": [0.485, 0.456, 0.406],
        "std": [0.229, 0.224, 0.225]
      },
      "grayscale": {
        "enabled": false,
        "num_output_channels": 3
      },
      "color_jitter": {
        "enabled": false,
        "brightness": 0.0,
        "contrast": 0.0,
        "saturation": 0.0,
        "hue": 0.0
      },
      "gaussian_blur": {
        "enabled": false,
        "kernel_size": 3,
        "sigma": 1.0
      },
      "cache_dataset": "ram_limited",
      "scaling": {
        "method": "Bicubic",
        "maintain_aspect_ratio": true,
        "pad_to_square": true,
        "pad_mode": "reflection",
        "pad_value": 0
      },
      "random_resize_crop": {
        "enabled": true,
        "size": 380,
        "scale": [0.8, 1.0],
        "ratio": [0.75, 1.33]
      }
    },
    "monitoring": {
      "metrics": {
        "accuracy": true,
        "precision": true,
        "recall": true,
        "f1": true,
        "topk": [3, 5, 10],
        "confusion_matrix": true,
        "auc": true,
        "gpu_utilization": true,
        "memory_usage": true
      },
      "tensorboard": {
        "enabled": true,
        "log_dir": "logs/efficientnet_b4_classification",
        "update_freq": 50
      },
      "wandb": {
        "enabled": false,
        "project": "image_classification",
        "entity": "",
        "tags": ["efficientnet", "classification", "b4"]
      },
      "checkpoint": {
        "enabled": true,
        "dir": "checkpoints/efficientnet_b4_classification",
        "save_best_only": true,
        "monitor": "val_loss",
        "mode": "min",
        "save_freq": 1
      },
      "early_stopping": {
        "enabled": true,
        "monitor": "val_loss",
        "mode": "min",
        "patience": 20,
        "min_delta": 0.0005
      },
      "reduce_lr": {
        "enabled": false,
        "monitor": "val_loss",
        "mode": "min",
        "factor": 0.5,
        "patience": 8,
        "min_delta": 0.0001,
        "min_lr": 1e-7
      }
    },
    "advanced": {
      "seed": 42,
      "deterministic": false,
      "benchmark": true,
      "gradient_clip_val": 1.0,
      "gradient_clip_norm": 1.0,
      "gradient_clip_algorithm": "norm",
      "accumulate_grad_batches": 6,
      "sync_batchnorm": false,
      "precision": "16-mixed",
      "amp_level": "O1",
      "gradient_clip_agc": {
        "use": false,
        "clipping": 0.01,
        "eps": 0.001
      }
    },
    "optimization": {
      "cudnn_benchmark": true,
      "pin_memory": true,
      "shuffle": true,
      "prefetch_factor": 4,
      "persistent_workers": true,
      "drop_last": false,
      "dataloader": {
        "pin_memory": true,
        "shuffle": true,
        "prefetch_factor": 4,
        "persistent_workers": true,
        "drop_last": false
      }
    }
  }
}
